LANGUAGE=en
?plot
roxygenize()
roxygenise()
library(roxygen2)
roxygenise()
setwd("~/Apps, Websites/xadmix")
library(devtools);
load_all("."); # Working directory should be in the package SCC_R_package
?admix_barplot
library(devtools);
load_all("."); # Working directory should be in the package SCC_R_package
admix_barplot()
setwd("C:/Users/profs/OneDrive - Office365.boku.ac.at/Dokumente/Uni/Boku/MA-BT/VU-Bioinformatics-lab-rotation/genomic-admixture/documents-export-2022-06-24")
admix <- read.csv("./admix_2.k16", sep = "\t")
del_acc <- c(
"UG_251042_", "UG_467869_", "UG_518306_", "UG_518324_", "UG_518338_", "UG_518355_",
"UG_518405_", "UG_518411_", "UG_540625_", "UG_540632_", "UG_540638_", "UG_540652_",
"UG_540676_", "UG_540678_", "UG_540682_", "UG_540684_", "UG_562581_"
)
admix <- subset(admix, !accession %in% del_acc)
admix <- na.omit(admix)
str(admix)
admix_barplot(admix, 4:19)
library(gtools) # allows mixedsort, to get correct order of ancestry levels
library(ggplot2) # plotting
library(forcats) # for handling factors
library(ggthemes) # to use theme_minimal()
# library(patchwork) # to combine multiple plots
# library(tidyr) # to handle dataframes
library(dplyr) # data manipulation
library(wesanderson) # additional color palettes
library(viridis) # additional color palettes
admix_barplot(admix, 4:19)
library(gtools) # allows mixedsort, to get correct order of ancestry levels
library(ggplot2) # plotting
library(forcats) # for handling factors
library(ggthemes) # to use theme_minimal()
# library(patchwork) # to combine multiple plots
library(tidyr) # to handle dataframes
library(dplyr) # data manipulation
library(wesanderson) # additional color palettes
library(viridis) # additional color palettes
admix_barplot(admix, 4:19)
library(devtools);
load_all("."); # Working directory should be in the package SCC_R_package
setwd("~/Apps, Websites/xadmix")
library(devtools);
load_all("."); # Working directory should be in the package SCC_R_package
admix_barplot(admix)
library(devtools);
load_all("."); # Working directory should be in the package SCC_R_package
admix_barplot(admix)
type(admix[,1])
typeof(admix[,1])
typeof(admix[,2])
typeof(admix[,3])
typeof(admix[,4])
typeof(admix[,4:19])
typ <- typeof(admix[,4:19])
typeof(admix)
sapply(admix, class)
sapply(admix[5], class)
sapply(admix[4:19], class)
is.numeric(sapply(admix[4:19], class))
sapply(sapply(admix[4:19], class), is.numeric)
sapply(sapply(admix[1:19], class), is.numeric)
lapply(admix[4:19], class)
lapply(admix[4:19], class) -> isnum
is.numeric(isnum)
sapply(isnum, is.numeric)
admix[,4:19]
admix[,4:19] %>% is.numeric
admix[,4:19] %>% as.matrix
mat <- as.matrix(admix[,4:19])
mat %>% is.numeric
library(devtools);
load_all("."); # Working directory should be in the package SCC_R_package
barplot(admix)
View(mat)
is.numeric(as.matrix(admix[,4:19]))
!is.numeric(as.matrix(admix[,4:19]))
!is.numeric(as.matrix(admix[,2:19]))
library(devtools);
load_all("."); # Working directory should be in the package SCC_R_package
barplot(admix)
barplot(admix, K = 4:19)
admix_barplot(admix, K = 4:19)
admix_barplot(admix,)
admix_barplot(admix)
?admix_barplot
roxygen()
roxygenize()
?admix_barplot
admix_barplot(admix, 4:19, grouping = "species", names = FALSE, sortkey = "anc1")
library(devtools);
load_all("."); # Working directory should be in the package SCC_R_package
admix_barplot(admix, 4:19, grouping = "species", names = FALSE, sortkey = "anc1")
admix_barplot(admix, 4:19, grouping = "species", names = FALSE, sortkey = "anc1")
library(devtools);
load_all("."); # Working directory should be in the package SCC_R_package
admix_barplot(admix, 4:19, grouping = "species", names = FALSE, sortkey = "anc1")
admix_barplot(admix, 4:19, grouping = "species", names = FALSE, sortkey = "anc1") -> pg
pg
pg -> ggplotGrob(pg)
library(ggplot2)
pg -> ggplotGrob(pg)
ggplotGrob(pg)
ggplotGrob(pg) -> pg
pg
for(i in which(grepl("strip-r", pg$layout$name))){
pg$grobs[[i]]$layout$clip <- "off"
}
grid::grid.draw(pg)
grid::grid.draw(pg)
admix_barplot(admix, 4:19, grouping = "species", names = FALSE, sortkey = "anc1")
admix_barplot(admix, 4:19, grouping = "species", names = FALSE, sortkey = "anc1") -> pp
pg <- ggplotGrob(pp)
for(i in which(grepl("strip-r", pg$layout$name))){
pg$grobs[[i]]$layout$clip <- "off"
}
grid::grid.draw(pg)
pg <- ggplotGrob(pp)
for(i in which(grepl("panel-1-6", pg$layout$name))){
pg$grobs[[i]]$layout$clip <- "off"
}
grid::grid.draw(pg)
pg <- ggplotGrob(pp)
for(i in which(grepl("strip-b-1", pg$layout$name))){
pg$grobs[[i]]$layout$clip <- "off"
}
grid::grid.draw(pg)
pg <- ggplotGrob(pp)
for(i in which(grepl("axis-b-6", pg$layout$name))){
pg$grobs[[i]]$layout$clip <- "off"
}
grid::grid.draw(pg)
pg <- ggplotGrob(pp)
for(i in which(grepl("axis-t-6", pg$layout$name))){
pg$grobs[[i]]$layout$clip <- "off"
}
grid::grid.draw(pg)
pg <- ggplotGrob(pp)
for(i in which(grepl("x-lab-b", pg$layout$name))){
pg$grobs[[i]]$layout$clip <- "off"
}
grid::grid.draw(pg)
pg <- ggplotGrob(pp)
for(i in which(grepl("x-lab-t", pg$layout$name))){
pg$grobs[[i]]$layout$clip <- "off"
}
grid::grid.draw(pg)
pg <- ggplotGrob(pp)
for(i in which(grepl("*", pg$layout$name))){
pg$grobs[[i]]$layout$clip <- "off"
}
grid::grid.draw(pg)
library(devtools);
load_all("."); # Working directory should be in the package SCC_R_package
admix_barplot(admix, 4:19)
admix_barplot(admix, 4:19)
admix_barplot(admix, 4:19, grouping = "species")
admix_barplot(admix, 4:19, grouping = "species", names = FALSE)
dev.new()
admix_barplot(admix, 4:19, grouping = "species", names = FALSE, noclip = TRUE)
library(devtools);
load_all("."); # Working directory should be in the package SCC_R_package
admix_barplot(admix, 4:19, grouping = "species", names = FALSE, noclip = TRUE)
library(devtools);
load_all("."); # Working directory should be in the package SCC_R_package
admix_barplot(admix, 4:19, grouping = "species", names = FALSE, noclip = TRUE)
pg <- ggplotGrob(pp)
for(i in which(grepl("*", pg$layout$name))){
pg$grobs[[i]]$layout$clip <- "off"
}
grid::grid.draw
library(devtools);
load_all("."); # Working directory should be in the package SCC_R_package
admix_barplot(admix, 4:19, grouping = "species", names = FALSE, noclip = TRUE)
admix_barplot(admix, 4:19, grouping = "species", names = FALSE, noclip = TRUE)
library(devtools);
load_all("."); # Working directory should be in the package SCC_R_package
admix_barplot(admix, 4:19, grouping = "species", names = FALSE, noclip = TRUE)
library(devtools);
load_all("."); # Working directory should be in the package SCC_R_package
admix_barplot(admix, 4:19, grouping = "species", names = FALSE, noclip = TRUE)
admix_barplot(admix, 4:19, grouping = "species", names = FALSE, noclip = TRUE) -> tplt
library(devtools);
load_all("."); # Working directory should be in the package SCC_R_package
admix_barplot(admix, 4:19, grouping = "species", names = FALSE, noclip = TRUE)
library(devtools);
load_all("."); # Working directory should be in the package SCC_R_package
admix_barplot(admix, 4:19, grouping = "species", names = FALSE, noclip = TRUE)
roxygenize()
?admix_barplot
usethis::use_tidy_description()
roxygenize()
roxygenize()
roxygenize()
roxygenize()
usethis::use_tidy_description()
admix_barplot(admix)
admix_barplot(admix[3:19])
admix_barplot(admix[,3:19])
admix[,3:19]
admix[,3:19] ->admixa
admix_barplot(admixa)
admix_barplot(admix)
admix[,c(1,4:19)] ->admixa
admix_barplot(admixa)
roxygenize()
roxygenize()
roxygenize()
?admix_barplot
